{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Set the page title shown in the browser tab -->
    <title>Zettar</title>
    <!-- Define character encoding as UTF-8 (standard for modern web) -->
    <meta charset="UTF-8">
    <!-- Load Inter font from Google Fonts for consistent typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <!-- Load Tailwind CSS via CDN for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ensure elements with x-cloak (Alpine-specific) are hidden until Alpine is ready -->
    <style>[x-cloak] { display: none !important; }</style>
    <!-- Load Alpine.js (lightweight reactive JavaScript framework) -->
    <script src="https://unpkg.com/alpinejs" defer></script>
    <!-- Initialize global Alpine store for app-wide state management -->
    <script src="{% static 'location_input/js/alpine_global_store_init.js' %}"></script>
    <!-- Load custom Alpine-driven form behavior (e.g. submission logic) -->
    <script src="{% static 'location_input/js/estimate_form.js' %}" defer></script>
    <!-- Load map logic for handling Google Maps integration and marker interaction -->
    <script type="module" src="{% static 'location_input/js/map_script.js' %}"></script>
    <!-- <script src="{% static 'location_input/js/map_script.js' %}" async defer></script> -->
    <!-- Load Google Maps JavaScript API and call `initMap` when loaded -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxQ51BfivW16FpJSX99-TFVlM5lsuK8N0&callback=initMap&loading=async"></script>

</head>
<body class="font-[Inter] bg-gray-50 min-h-screen">


    {% include 'partials/header.html' %}

    <main x-data class="flex flex-col h-[calc(100vh-80px)] max-w-7xl mx-auto p-4 space-y-6">

        <div class="flex flex-1 gap-6">

            <div class="w-2/3 h-full">
                <div class="bg-white rounded-2xl shadow h-full">
                    <div id="map" class="w-full h-full rounded-2xl"></div>
                </div>
            </div>

  
            <div class="w-1/3 h-full flex flex-col gap-6">
                <div class="bg-white rounded-2xl shadow p-4">
                    <h2 class="text-xl font-semibold mb-2">Quickly Estimate Your PoC Connection Costs</h2>
                    <p class="text-gray-700">With Zettar, there's no need to wait for a formal grid offer to understand your connection costs. Just choose your site location, select your energy supply type, and submitâ€”Zettar handles the rest, providing fast, accurate estimates in seconds.</p>
                </div>

                <div class="bg-white rounded-2xl shadow p-4 flex items-center justify-start">
                    <h2 class="text-xl font-semibold">1. Select a Location</h2>
                </div>

                <!-- Which type of connection do you need? -->
                <div class="bg-white rounded-2xl shadow p-4">
                    <h2 class="text-xl font-semibold mb-2">2. Select which type of connection do you need?</h2>
                    <fieldset class="space-y-3">
                        <legend class="sr-only">Connection Type</legend>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="primary" class="accent-blue-600" @change="$store.app.connectionType = 'Primary'">
                        <span class="text-gray-800 font-medium">Primary</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="secondary" class="accent-blue-600" @change="$store.app.connectionType = 'Secondary'">
                        <span class="text-gray-800 font-medium">Secondary</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="bsp" class="accent-blue-600" @change="$store.app.connectionType = 'Bulk Supply Point (BSP)'">
                        <span class="text-gray-800 font-medium">Bulk Supply Point (BSP)</span>
                        </label>
                    </fieldset>
                </div>



                <!--  -->


                <div class="bg-white rounded-2xl shadow p-4 flex-1 overflow-auto">
                    <h2 class="text-xl font-semibold mb-2">3. Generate Estimate</h2>
                    <button type="button"
                        class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mx-auto block"
                        @click="$store.app.submitEstimate()">
                        Calculate Estimate
                    </button>
                </div>

            </div>

            


        </div>

        <!-- âœ… This goes directly under the two-column layout -->
            <div 
                id="estimate-box"
                x-show="$store.app.showEstimate"
                x-transition
                x-cloak  
                class="bg-white rounded-2xl shadow p-6 mt-6 max-w-7xl mx-auto w-full"
            >
                <h2 class="text-xl font-semibold mb-4">Connection Cost Estimate</h2>

                    <p class="text-3xl font-extrabold text-green-600 mb-4">
                    <span x-text="$store.app.GBPFormatCost"></span>
                    </p>

                    <div class="text-gray-700 space-y-3 text-base leading-relaxed">
                    <p>
                    This estimate includes:
                    </p>
                    <ul class="list-disc list-inside ml-2">
                    <li><strong>Upfront cost:</strong> Approximately <span class="font-semibold text-gray-800">[Â£X]</span> for a <span class="font-semibold text-gray-800">[substation type]</span>.</li>
                    <li><strong>Per metre cost:</strong> <span class="font-semibold text-gray-800">[Â£Y/m]</span> along the public road network.</li>
                    <li><strong>Distance:</strong> Your closest <span class="font-semibold text-gray-800">[substation_type]</span> is <span class="font-semibold text-gray-800">[name of substation]</span>, about <span class="font-semibold text-gray-800">[Y]m</span> away by public road.</li>
                    <li><strong>Additional buffer:</strong> We've added <span class="font-semibold text-gray-800">[X]m</span> for typical diversions (e.g. under a bridge, avoiding infrastructure).</li>
                    </ul>

                    <p>
                    ðŸ‘‰ This gives a total estimated route length of <span class="font-semibold text-gray-800">[Z]m</span>, and a combined estimated cost of <span class="font-bold text-green-700">Â£[Total]</span>.
                    </p>

                    <p class="italic text-sm text-gray-500">
                    Note: This is a high-level estimate based on typical conditions and public road routing. Actual costs may vary.
                    </p>

            </div>

    </main>

</body>
</html>
