{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Set the page title shown in the browser tab -->
    <title>Zettar</title>
    <!-- Define character encoding as UTF-8 (standard for modern web) -->
    <meta charset="UTF-8">
    <!-- Load Inter font from Google Fonts for consistent typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <!-- Load Tailwind CSS via CDN for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ensure elements with x-cloak (Alpine-specific) are hidden until Alpine is ready -->
    <style>[x-cloak] { display: none !important; }</style>
    <!-- Load Alpine.js (lightweight reactive JavaScript framework) -->
    <script src="https://unpkg.com/alpinejs" defer></script>
    <!-- Initialize global Alpine store for app-wide state management -->
    <script src="{% static 'location_input/js/alpine_global_store_init.js' %}"></script>
    <!-- Load custom Alpine-driven form behavior (e.g. submission logic) -->
    <!-- <script src="{% static 'location_input/js/estimate_form.js' %}" defer></script> -->
    <!-- Load map logic for handling Google Maps integration and marker interaction -->
    <script type="module" src="{% static 'location_input/js/map_script.js' %}"></script>
    <!-- <script src="{% static 'location_input/js/map_script.js' %}" async defer></script> -->
    <!-- Load Google Maps JavaScript API and call `initMap` when loaded -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxQ51BfivW16FpJSX99-TFVlM5lsuK8N0&callback=initMap&loading=async"></script>

</head>
<body class="font-[Inter] bg-gray-50 min-h-screen">


    {% include 'partials/header.html' %}

    <main x-data class="flex flex-col h-[calc(100vh-80px)] max-w-7xl mx-auto p-4 space-y-6">
    <!-- <main class="flex flex-col max-w-7xl mx-auto p-4 space-y-6 pb-12"> -->


        <div class="flex flex-1 gap-6">

            <div class="w-2/3 h-full">
                <div class="bg-white rounded-2xl shadow h-full">
                    <div id="map" class="w-full h-full rounded-2xl"></div>
                </div>
            </div>

  
            <div class="w-1/3 h-full flex flex-col gap-6">
                <div class="bg-white rounded-2xl shadow p-4">
                    <h2 class="text-xl font-semibold mb-2">Instantly Access Grid Application Insights</h2>
                    <p class="text-gray-700">
                        With Zettar, just drop a pin on your site, choose your substation type, and instantly see up-to-date data on existing grid connection applications at the nearest substations. Clear, fast, and hassle-free.
                    </p>
                </div>

                <!-- <div class="bg-white rounded-2xl shadow p-4 flex items-center justify-start">
                    <h2 class="text-xl font-semibold">1. Select a Location</h2>
                    <p class="text-gray-700">
                        Simply click the desired location on the map where you would put your site and drop the pin. Zettar then finds the nearest substation of your required type 
                    </p>
                </div> -->

                <!-- Which type of connection do you need? -->
                <div class="bg-white rounded-2xl shadow p-4">
                    <h2 class="text-xl font-semibold mb-2">1. Select Connection Type</h2>
                    <fieldset class="space-y-3">
                        <legend class="sr-only">Connection Type</legend>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="primary" class="accent-blue-600" @change="$store.app.connectionType = 'primary'">
                        <span class="text-gray-800 font-medium">Secondary</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="bsp" class="accent-blue-600" @change="$store.app.connectionType = 'bsp'">
                        <span class="text-gray-800 font-medium">Bulk Supply Point (BSP)</span>
                        </label>

                        <label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                        <input type="radio" name="connection_type" value="gsp" class="accent-blue-600" @change="$store.app.connectionType = 'gsp'">
                        <span class="text-gray-800 font-medium">Grid Supply Point (GSP)</span>
                        </label>
                    </fieldset>
                </div>

                <div class="bg-white rounded-2xl shadow p-4 space-y-2">
                    <h2 class="text-xl font-semibold">2. Select a Location</h2>
                    <p class="text-gray-700">
                        Click anywhere on the map to drop a pin at your desired site location. Zettar will automatically find the nearest substation that matches your selected type.
                    </p>
                </div>


                <div class="bg-white rounded-2xl shadow p-4 flex-1 overflow-auto">
                    <h2 class="text-xl font-semibold mb-2">3. Generate Insights</h2>
                    <button type="button"
                        class="bg-blue-600 text-white px-6 py-3 rounded-2xl text-lg font-semibold hover:bg-blue-700 transition duration-200 w-full"
                        @click="$store.app.generateInsights()">
                        Run Connection Check
                    </button>
                </div>

            </div>

            


        </div>

        <!-- âœ… This goes directly under the two-column layout -->
            <div 
                id="estimate-box"
                x-show="$store.app.nearestSubstationName"
                x-transition
                x-cloak  
                class="bg-white rounded-2xl shadow p-6 mt-6 mb-6 max-w-7xl mx-auto w-full"
            >
                <h2 class="text-xl font-semibold mb-4">Connection Insights</h2>

                    <p class="text-3xl font-extrabold text-green-600 mb-4">
                    <span x-text="$store.app.nearestSubstationName"></span>
                    </p>

            </div>

    </main>

</body>
</html>
