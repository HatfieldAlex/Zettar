{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Grid Connection Estimate</title>
    <link rel="stylesheet" href="{% static 'location_input/css/connection_results.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    {% include "partials/sidebar.html" %}

    <div class="main">
        <div class="card">
            <h1>Estimated Grid Connection Cost</h1>
            <p><strong>Latitude:</strong> {{ latitude }}</p>
            <p><strong>Longitude:</strong> {{ longitude }}</p>
        </div>

        {% if nearest_name and nearest_location %}
            <div class="card">
                <h2>Nearest Point of Connection</h2>
                <p><strong>Name:</strong> {{ nearest_name }}</p>
                <p><strong>Coordinates:</strong> {{ nearest_location }}</p>
            </div>

            {% if osrm_distance %}
                <div class="card">
                    <h3>Driving Distance</h3>
                    <p><strong>Distance via road network:</strong> {{ osrm_distance|floatformat:0 }} meters</p>
                </div>

                <div class="card cost-card">
                    <h3>Estimated Cost</h3>
                    <p class="cost">Â£{{ cost }}</p>
                </div>

                <div class="card">
                    <h3>Methodology</h3>
                    <p>
                        This estimate is based on your selected site location and the nearest viable grid point.
                        We calculate the <strong>driving distance</strong> (not straight-line) because trenching is generally constrained to roads and public right-of-ways.
                        The total cost includes a fixed design/admin cost and a per-metre rate:
                    </p>
                    <p class="formula">Estimated Cost = Upfront Cost + (Rate Ã— Road Distance)</p>
                    <p class="note">Note: This is a rough estimate. Final figures may vary based on DNO quotes, voltage level, and route conditions.</p>
                </div>
            {% else %}
                <div class="card">
                    <p><em>Could not calculate driving distance.</em></p>
                </div>
            {% endif %}
        {% else %}
            <div class="card">
                <p>No nearby substation found.</p>
            </div>
        {% endif %}

        <form action="/" method="get">
            <button type="submit">ðŸ”™ Go Back</button>
        </form>
    </div>
</body>
</html>
